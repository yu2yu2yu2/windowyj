<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Windows åº”æ€¥å“åº”æŠ¥å‘ŠæŸ¥çœ‹å™¨ (è¯¦ç»†ç‰ˆ)</title>
<style>
body { 
  font-family: "Microsoft YaHei", Arial, sans-serif; 
  background: #f5f5f5; 
  margin: 0;
  padding: 0;
}

.header {
  background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
  color: white;
  padding: 20px;
  text-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.header h1 {
  margin: 0;
  font-size: 2.2em;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.subtitle {
  margin-top: 8px;
  font-size: 1.1em;
  opacity: 0.9;
}

.main-container {
  display: flex;
  max-width: 1400px;
  margin: 20px auto;
  gap: 20px;
  padding: 0 20px;
}

.content-container {
  flex: 1;
  background: white;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  overflow: hidden;
}

.search-container {
  padding: 20px;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  display: flex;
  gap: 15px;
  align-items: center;
  flex-wrap: wrap;
}

.search-container input[type="file"] {
  padding: 10px;
  border: 2px solid #3498db;
  border-radius: 5px;
  background: white;
  font-size: 14px;
}

.search-container input[type="text"] {
  flex: 1;
  min-width: 200px;
  padding: 10px;
  border: 2px solid #bdc3c7;
  border-radius: 5px;
  font-size: 14px;
}

.search-container input[type="text"]:focus {
  border-color: #3498db;
  outline: none;
}

.search-nav {
  display: flex;
  gap: 10px;
  align-items: center;
}

.search-nav button {
  padding: 8px 15px;
  background: #3498db;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 12px;
}

.search-nav button:disabled {
  background: #bdc3c7;
  cursor: not-allowed;
}

.search-nav button:hover:not(:disabled) {
  background: #2980b9;
}

#searchCount {
  font-size: 12px;
  color: #7f8c8d;
  white-space: nowrap;
}

.tabs {
  display: flex;
  background: #ecf0f1;
  border-bottom: 1px solid #bdc3c7;
  overflow-x: auto;
}

.tablinks {
  background: none;
  border: none;
  padding: 15px 20px;
  cursor: pointer;
  font-size: 14px;
  color: #2c3e50;
  white-space: nowrap;
  transition: all 0.3s ease;
  border-bottom: 3px solid transparent;
}

.tablinks:hover {
  background: #d5dbdb;
}

.tablinks.active {
  background: white;
  color: #3498db;
  border-bottom-color: #3498db;
}

.tabcontent {
  display: none;
  padding: 25px;
  max-height: 70vh;
  overflow-y: auto;
}

.tabcontent.active {
  display: block;
}

details {
  margin: 15px 0;
  border: 1px solid #dee2e6;
  border-radius: 8px;
  overflow: hidden;
}

summary {
  background: #f8f9fa;
  padding: 15px 20px;
  cursor: pointer;
  font-weight: bold;
  color: #2c3e50;
  border-bottom: 1px solid #dee2e6;
  transition: background 0.3s ease;
}

summary:hover {
  background: #e9ecef;
}

details[open] summary {
  background: #3498db;
  color: white;
}

details div {
  padding: 20px;
  background: white;
}

pre {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 5px;
  border-left: 4px solid #3498db;
  overflow-x: auto;
  font-family: "Consolas", "Monaco", monospace;
  font-size: 13px;
  line-height: 1.4;
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sidebar {
  width: 350px;
  background: white;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  height: fit-content;
  max-height: 80vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.sidebar-header {
  background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
  color: white;
  padding: 20px;
  text-align: center;
  position: relative;
}

.sidebar-header h3 {
  margin: 0;
  font-size: 1.3em;
}

.collapse-button {
  position: absolute;
  top: 50%;
  right: 15px;
  transform: translateY(-50%);
  background: rgba(255,255,255,0.2);
  color: white;
  border: none;
  padding: 5px 10px;
  border-radius: 15px;
  cursor: pointer;
  font-size: 12px;
  transition: background 0.3s ease;
}

.collapse-button:hover {
  background: rgba(255,255,255,0.3);
}

.alert-summary {
  margin-top: 15px;
  padding: 15px;
  background: rgba(255,255,255,0.1);
  border-radius: 8px;
  font-size: 14px;
}

.alert-container {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.alert-item {
  margin: 15px 0;
  padding: 15px;
  border-radius: 8px;
  border-left: 4px solid;
  font-size: 14px;
  line-height: 1.5;
}

.alert-high {
  background: #fdf2f2;
  border-color: #e53e3e;
  color: #742a2a;
}

.alert-medium {
  background: #fffbf0;
  border-color: #dd6b20;
  color: #7c2d12;
}

.alert-low {
  background: #f0fff4;
  border-color: #38a169;
  color: #22543d;
}

.alert-item h4 {
  margin: 0 0 8px 0;
  font-size: 15px;
}

.alert-item p {
  margin: 5px 0;
  font-size: 13px;
}

.highlight {
  background: #fff3cd !important;
  border: 2px solid #ffc107 !important;
  border-radius: 4px;
  padding: 2px 4px;
}

.sidebar.collapsed {
  width: 60px;
}

.sidebar.collapsed .sidebar-header h3,
.sidebar.collapsed .alert-summary,
.sidebar.collapsed .alert-container {
  display: none;
}

.sidebar.collapsed .collapse-button {
  right: 50%;
  transform: translate(50%, -50%);
}

@media (max-width: 768px) {
  .main-container {
    flex-direction: column;
    padding: 0 10px;
  }
  
  .sidebar {
    width: 100%;
    order: -1;
  }
  
  .search-container {
    flex-direction: column;
    align-items: stretch;
  }
  
  .search-nav {
    justify-content: center;
  }
  
  .tabs {
    flex-wrap: wrap;
  }
  
  .tablinks {
    flex: 1;
    min-width: 120px;
    text-align: center;
  }
}

/* æ•™ç¨‹æ ·å¼ */
.tutorial-content {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 10px;
  margin: 10px 0;
}

.tutorial-content h3 {
  color: #2c3e50;
  margin-bottom: 20px;
  font-size: 1.5em;
  border-bottom: 2px solid #3498db;
  padding-bottom: 10px;
}

.tutorial-content h4 {
  color: #34495e;
  margin: 20px 0 10px 0;
  font-size: 1.2em;
}

.tutorial-content ul, .tutorial-content ol {
  margin: 15px 0;
  padding-left: 25px;
}

.tutorial-content li {
  margin: 8px 0;
  line-height: 1.6;
}

.tutorial-content .command-block {
  background: #2d3748;
  color: #e2e8f0;
  padding: 15px;
  border-radius: 5px;
  font-family: "Consolas", "Monaco", monospace;
  margin: 15px 0;
  overflow-x: auto;
}

.tutorial-content .warning {
  background: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 5px;
  padding: 15px;
  margin: 15px 0;
}

.tutorial-content .tip {
  background: #d1ecf1;
  border: 1px solid #bee5eb;
  border-radius: 5px;
  padding: 15px;
  margin: 15px 0;
}
</style>

<script>
// å…¨å±€å˜é‡
const TAB_TITLES = {
  summary: "ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ",
  system: "ğŸ’» ç³»ç»Ÿä¿¡æ¯", 
  user: "ğŸ‘¥ ç”¨æˆ·æƒé™",
  process: "âš™ï¸ è¿›ç¨‹æœåŠ¡",
  network: "ğŸŒ ç½‘ç»œè¿æ¥",
  filesystem: "ğŸ“ æ–‡ä»¶ç³»ç»Ÿ",
  registry: "ğŸ“‹ æ³¨å†Œè¡¨",
  logs: "ğŸ“‹ æ—¥å¿—åˆ†æ",
  tasks: "â° è®¡åˆ’ä»»åŠ¡",
  malware: "ğŸ¦  æ¶æ„è½¯ä»¶æ£€æµ‹",
  stats: "ğŸ“ˆ å®‰å…¨ç»Ÿè®¡"
};

const SUB_TAB_TITLES = {
  summary: ["ç³»ç»Ÿæ¦‚è§ˆ", "é£é™©è¯„ä¼°", "æ™ºèƒ½å»ºè®®", "æ£€æŸ¥æ¸…å•", "ä¸“ä¸šæ€»ç»“"],
  system: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "åŸºæœ¬ç³»ç»Ÿä¿¡æ¯", "å·²å®‰è£…è¡¥ä¸ä¿¡æ¯", "é‡è¦ç¯å¢ƒå˜é‡"],
  user: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æœ¬åœ°ç”¨æˆ·è´¦æˆ·", "ç®¡ç†å‘˜ç»„æˆå‘˜", "å½“å‰ç™»å½•ç”¨æˆ·", "æœ€è¿‘ç™»å½•è®°å½•"],
  process: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "é«˜CPUå ç”¨è¿›ç¨‹", "å¯ç–‘è¿›ç¨‹æ£€æŸ¥", "è¿è¡Œä¸­çš„ç³»ç»ŸæœåŠ¡", "å¯åŠ¨é¡¹"],
  network: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æ´»åŠ¨ç½‘ç»œè¿æ¥", "ç›‘å¬ç«¯å£", "ç½‘ç»œé…ç½®", "DNSé…ç½®"],
  filesystem: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æœ€è¿‘ä¿®æ”¹çš„ç³»ç»Ÿæ–‡ä»¶", "ä¸´æ—¶ç›®å½•å¯ç–‘æ–‡ä»¶", "ä¸‹è½½ç›®å½•æœ€è¿‘æ–‡ä»¶"],
  registry: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æ³¨å†Œè¡¨å¯åŠ¨é¡¹", "å¯ç–‘æœåŠ¡æ³¨å†Œè¡¨", "æœ€è¿‘è®¿é—®çš„æ–‡ä»¶è®°å½•"],
  logs: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "ç™»å½•å¤±è´¥è®°å½•", "ç³»ç»Ÿé”™è¯¯äº‹ä»¶", "åº”ç”¨ç¨‹åºé”™è¯¯äº‹ä»¶"],
  tasks: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "æ´»åŠ¨è®¡åˆ’ä»»åŠ¡", "å¯ç–‘è®¡åˆ’ä»»åŠ¡"],
  malware: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "Windows DefenderçŠ¶æ€", "å¯ç–‘ç½‘ç»œè¿æ¥", "å¼‚å¸¸è¿›ç¨‹æ£€æŸ¥"],
  stats: ["ğŸ“š ç»Ÿè®¡æ•™ç¨‹", "ç”¨æˆ·å®‰å…¨ç»Ÿè®¡", "è¿›ç¨‹å®‰å…¨ç»Ÿè®¡", "ç½‘ç»œå®‰å…¨ç»Ÿè®¡", "æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡", "æ³¨å†Œè¡¨ç»Ÿè®¡", "è®¡åˆ’ä»»åŠ¡ç»Ÿè®¡", "æ—¥å¿—ç»Ÿè®¡", "å®‰å…¨é˜²æŠ¤çŠ¶æ€", "å®‰å…¨é£é™©è¯„ä¼°", "ä¸“ä¸šå®‰å…¨å»ºè®®"]
};

let gTabs = Object.keys(TAB_TITLES);
let gContent = "";
let currentSearchIndex = -1;
let searchMatches = [];
let analysisData = null;

// ç”ŸæˆWindowsæ•™ç¨‹å†…å®¹
function generateWindowsTutorial(category) {
  const tutorials = {
    system: `
<div class="tutorial-content">
<h3>ğŸ›¡ï¸ Windowsç³»ç»Ÿä¿¡æ¯å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç³»ç»Ÿä¿¡æ¯æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç³»ç»Ÿä¿¡æ¯æ˜¯äº†è§£Windowsç¯å¢ƒå®‰å…¨çŠ¶å†µçš„åŸºç¡€ã€‚é€šè¿‡ç³»ç»Ÿä¿¡æ¯æ£€æŸ¥å¯ä»¥å‘ç°ç³»ç»Ÿæ¼æ´ã€é…ç½®é—®é¢˜å’Œæ½œåœ¨çš„å®‰å…¨é£é™©ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>æ“ä½œç³»ç»Ÿç‰ˆæœ¬</strong> - ç¡®è®¤ç³»ç»Ÿç‰ˆæœ¬å’Œè¡¥ä¸çº§åˆ«</li>
<li><strong>è¡¥ä¸å®‰è£…æƒ…å†µ</strong> - æ£€æŸ¥å…³é”®å®‰å…¨è¡¥ä¸æ˜¯å¦å®‰è£…</li>
<li><strong>ç³»ç»Ÿé…ç½®</strong> - éªŒè¯å®‰å…¨é…ç½®æ˜¯å¦åˆè§„</li>
<li><strong>ç¡¬ä»¶ä¿¡æ¯</strong> - äº†è§£ç³»ç»Ÿç¡¬ä»¶é…ç½®</li>
<li><strong>ç¯å¢ƒå˜é‡</strong> - æ£€æŸ¥å¯èƒ½è¢«åŠ«æŒçš„ç¯å¢ƒå˜é‡</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. è·å–ç³»ç»ŸåŸºæœ¬ä¿¡æ¯
Get-ComputerInfo

# 2. æŸ¥çœ‹æ“ä½œç³»ç»Ÿè¯¦ç»†ä¿¡æ¯
Get-CimInstance -ClassName Win32_OperatingSystem

# 3. æ£€æŸ¥å·²å®‰è£…çš„è¡¥ä¸
Get-HotFix | Sort-Object InstalledOn -Descending

# 4. æŸ¥çœ‹ç³»ç»Ÿå¯åŠ¨æ—¶é—´
Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object LastBootUpTime

# 5. æ£€æŸ¥ç¯å¢ƒå˜é‡
Get-ChildItem Env:

# 6. æŸ¥çœ‹ç³»ç»ŸæœåŠ¡
Get-Service | Where-Object {$_.Status -eq "Running"}

# 7. æ£€æŸ¥WindowsåŠŸèƒ½
Get-WindowsOptionalFeature -Online | Where-Object {$_.State -eq "Enabled"}
</div>

<h4>ğŸš¨ å®‰å…¨æ£€æŸ¥é‡ç‚¹</h4>
<ul>
<li><strong>è¡¥ä¸ç®¡ç†</strong> - ç¡®ä¿å…³é”®å®‰å…¨è¡¥ä¸å·²å®‰è£…</li>
<li><strong>ç³»ç»Ÿç‰ˆæœ¬</strong> - ä½¿ç”¨å—æ”¯æŒçš„Windowsç‰ˆæœ¬</li>
<li><strong>å¯åŠ¨æ—¶é—´</strong> - å¼‚å¸¸çš„é‡å¯å¯èƒ½è¡¨ç¤ºç³»ç»Ÿè¢«æ”»å‡»</li>
<li><strong>ç¯å¢ƒå˜é‡</strong> - PATHç­‰å˜é‡æ˜¯å¦è¢«æ¶æ„ä¿®æ”¹</li>
<li><strong>ç³»ç»ŸåŠŸèƒ½</strong> - ä¸å¿…è¦çš„åŠŸèƒ½åº”è¯¥è¢«ç¦ç”¨</li>
</ul>

<h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>å®šæœŸæ£€æŸ¥Windows UpdateçŠ¶æ€</li>
<li>å…³æ³¨Microsoftå®‰å…¨å…¬å‘Š</li>
<li>ç›‘æ§ç³»ç»Ÿé…ç½®å˜åŒ–</li>
<li>å»ºç«‹ç³»ç»ŸåŸºçº¿é…ç½®</li>
</ul>
</div>
    `,
    
    user: `
<div class="tutorial-content">
<h3>ğŸ‘¥ Windowsç”¨æˆ·æƒé™å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç”¨æˆ·æƒé™æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç”¨æˆ·è´¦æˆ·ç®¡ç†æ˜¯Windowså®‰å…¨çš„æ ¸å¿ƒã€‚æ”»å‡»è€…å¸¸å¸¸é€šè¿‡åˆ›å»ºåé—¨è´¦æˆ·ã€æå‡æƒé™æˆ–åˆ©ç”¨å¼±å¯†ç æ¥ç»´æŒç³»ç»Ÿè®¿é—®ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>æœ¬åœ°ç”¨æˆ·è´¦æˆ·</strong> - æ£€æŸ¥æ‰€æœ‰æœ¬åœ°ç”¨æˆ·çš„åˆæ³•æ€§</li>
<li><strong>ç®¡ç†å‘˜æƒé™</strong> - å®¡æŸ¥ç®¡ç†å‘˜ç»„æˆå‘˜</li>
<li><strong>ç™»å½•æ´»åŠ¨</strong> - åˆ†æç”¨æˆ·ç™»å½•è¡Œä¸º</li>
<li><strong>å¯†ç ç­–ç•¥</strong> - éªŒè¯å¯†ç å®‰å…¨ç­–ç•¥</li>
<li><strong>ç”¨æˆ·ç»„æƒé™</strong> - æ£€æŸ¥ç”¨æˆ·ç»„é…ç½®</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æœ¬åœ°ç”¨æˆ·è´¦æˆ·
Get-LocalUser

# 2. æ£€æŸ¥ç®¡ç†å‘˜ç»„æˆå‘˜
Get-LocalGroupMember -Group "Administrators"

# 3. æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°ç»„
Get-LocalGroup

# 4. æ£€æŸ¥å½“å‰ç™»å½•ç”¨æˆ·
Get-CimInstance -ClassName Win32_LoggedOnUser

# 5. æŸ¥çœ‹ç”¨æˆ·ç™»å½•å†å²
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} -MaxEvents 50

# 6. æ£€æŸ¥ç™»å½•å¤±è´¥è®°å½•
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} -MaxEvents 50

# 7. æŸ¥çœ‹å¯†ç ç­–ç•¥
net accounts

# 8. æ£€æŸ¥ç”¨æˆ·æƒé™åˆ†é…
secedit /export /cfg security_config.txt
</div>

<h4>ğŸš¨ å®‰å…¨é£é™©è¯†åˆ«</h4>
<ul>
<li><strong>å¼‚å¸¸ç®¡ç†å‘˜è´¦æˆ·</strong> - æ£€æŸ¥æ˜¯å¦æœ‰æœªæˆæƒçš„ç®¡ç†å‘˜</li>
<li><strong>é»˜è®¤è´¦æˆ·çŠ¶æ€</strong> - Guestè´¦æˆ·åº”è¯¥è¢«ç¦ç”¨</li>
<li><strong>å¼±å¯†ç ç­–ç•¥</strong> - å¯†ç å¤æ‚åº¦å’Œè¿‡æœŸç­–ç•¥</li>
<li><strong>å¼‚å¸¸ç™»å½•æ—¶é—´</strong> - éå·¥ä½œæ—¶é—´çš„ç™»å½•æ´»åŠ¨</li>
<li><strong>ç™»å½•å¤±è´¥æ¨¡å¼</strong> - æš´åŠ›ç ´è§£æ”»å‡»è¿¹è±¡</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®æ–½æœ€å°æƒé™åŸåˆ™</li>
<li>å®šæœŸå®¡æŸ¥ç”¨æˆ·è´¦æˆ·</li>
<li>å¯ç”¨è´¦æˆ·é”å®šç­–ç•¥</li>
<li>ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥</li>
<li>ç›‘æ§ç™»å½•æ´»åŠ¨</li>
</ul>
</div>
    `,
    
    process: `
<div class="tutorial-content">
<h3>âš™ï¸ Windowsè¿›ç¨‹æœåŠ¡å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– è¿›ç¨‹æœåŠ¡æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ¶æ„è¿›ç¨‹å’ŒæœåŠ¡æ˜¯æ”»å‡»è€…åœ¨Windowsç³»ç»Ÿä¸­æ‰§è¡Œæ¶æ„æ´»åŠ¨çš„ä¸»è¦è½½ä½“ã€‚é€šè¿‡è¿›ç¨‹åˆ†æå¯ä»¥å‘ç°åé—¨ç¨‹åºã€æ¶æ„è½¯ä»¶å’Œå¼‚å¸¸æ´»åŠ¨ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>è¿›ç¨‹è¡Œä¸ºåˆ†æ</strong> - åˆ†æè¿›ç¨‹çš„èµ„æºä½¿ç”¨å’Œè¡Œä¸º</li>
<li><strong>æœåŠ¡çŠ¶æ€æ£€æŸ¥</strong> - æ£€æŸ¥ç³»ç»ŸæœåŠ¡çš„åˆæ³•æ€§</li>
<li><strong>å¯åŠ¨é¡¹å®¡æŸ¥</strong> - æ£€æŸ¥è‡ªå¯åŠ¨ç¨‹åº</li>
<li><strong>è¿›ç¨‹ç­¾åéªŒè¯</strong> - éªŒè¯è¿›ç¨‹çš„æ•°å­—ç­¾å</li>
<li><strong>ç½‘ç»œè¿æ¥å…³è”</strong> - åˆ†æè¿›ç¨‹çš„ç½‘ç»œæ´»åŠ¨</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹è¯¦ç»†ä¿¡æ¯
Get-Process | Select-Object Name, Id, CPU, WorkingSet, Path

# 2. æŒ‰CPUä½¿ç”¨ç‡æ’åº
Get-Process | Sort-Object CPU -Descending | Select-Object -First 20

# 3. æŸ¥çœ‹è¿›ç¨‹çš„ç½‘ç»œè¿æ¥
Get-NetTCPConnection | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State, OwningProcess

# 4. æ£€æŸ¥ç³»ç»ŸæœåŠ¡
Get-Service | Where-Object {$_.Status -eq "Running"}

# 5. æŸ¥çœ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯
Get-CimInstance -ClassName Win32_Service | Select-Object Name, DisplayName, State, PathName

# 6. æ£€æŸ¥å¯åŠ¨é¡¹
Get-CimInstance -ClassName Win32_StartupCommand

# 7. æŸ¥çœ‹è¿›ç¨‹æ¨¡å—
Get-Process -Name "processname" | Select-Object -ExpandProperty Modules

# 8. æ£€æŸ¥è¿›ç¨‹çš„æ•°å­—ç­¾å
Get-AuthenticodeSignature -FilePath "C:\path\to\executable.exe"
</div>

<h4>ğŸš¨ å¯ç–‘è¿›ç¨‹ç‰¹å¾</h4>
<ul>
<li><strong>é«˜èµ„æºå ç”¨</strong> - å¼‚å¸¸é«˜çš„CPUæˆ–å†…å­˜ä½¿ç”¨</li>
<li><strong>å¼‚å¸¸è·¯å¾„</strong> - ä»ä¸´æ—¶ç›®å½•æˆ–ç”¨æˆ·ç›®å½•è¿è¡Œ</li>
<li><strong>æ— ç­¾åæ–‡ä»¶</strong> - ç¼ºå°‘æ•°å­—ç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li><strong>éšè—è¿›ç¨‹</strong> - ä½¿ç”¨ç‰¹æ®ŠæŠ€æœ¯éšè—çš„è¿›ç¨‹</li>
<li><strong>ç½‘ç»œæ´»åŠ¨</strong> - å¼‚å¸¸çš„ç½‘ç»œè¿æ¥è¡Œä¸º</li>
</ul>

<h4>ğŸ›¡ï¸ é˜²æŠ¤å»ºè®®</h4>
<ul>
<li>å®šæœŸç›‘æ§è¿›ç¨‹æ´»åŠ¨</li>
<li>ä½¿ç”¨åº”ç”¨ç¨‹åºç™½åå•</li>
<li>å¯ç”¨è¿›ç¨‹å®¡è®¡</li>
<li>ç›‘æ§æœåŠ¡çŠ¶æ€å˜åŒ–</li>
<li>éªŒè¯å¯æ‰§è¡Œæ–‡ä»¶ç­¾å</li>
</ul>
</div>
    `,
    
    network: `
<div class="tutorial-content">
<h3>ğŸŒ Windowsç½‘ç»œå®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç½‘ç»œå®‰å…¨æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç½‘ç»œè¿æ¥æ˜¯æ”»å‡»è€…è¿›å…¥ç³»ç»Ÿå’Œæ•°æ®å¤–æ³„çš„ä¸»è¦é€šé“ã€‚é€šè¿‡ç½‘ç»œæ£€æŸ¥å¯ä»¥å‘ç°åé—¨è¿æ¥ã€å¼‚å¸¸é€šä¿¡å’Œæ½œåœ¨çš„æ•°æ®æ³„éœ²è¡Œä¸ºã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>ç½‘ç»œè¿æ¥åˆ†æ</strong> - æ£€æŸ¥æ´»è·ƒçš„ç½‘ç»œè¿æ¥</li>
<li><strong>ç«¯å£ç›‘å¬æ£€æŸ¥</strong> - è¯†åˆ«å¼‚å¸¸çš„ç›‘å¬æœåŠ¡</li>
<li><strong>é˜²ç«å¢™çŠ¶æ€</strong> - æ£€æŸ¥Windowsé˜²ç«å¢™é…ç½®</li>
<li><strong>ç½‘ç»œé…ç½®</strong> - éªŒè¯ç½‘ç»œæ¥å£é…ç½®</li>
<li><strong>DNSè®¾ç½®</strong> - æ£€æŸ¥DNSé…ç½®å®‰å…¨æ€§</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¿æ¥
Get-NetTCPConnection

# 2. æŸ¥çœ‹ç›‘å¬ç«¯å£
Get-NetTCPConnection | Where-Object {$_.State -eq "Listen"}

# 3. æŸ¥çœ‹æ´»è·ƒè¿æ¥
Get-NetTCPConnection | Where-Object {$_.State -eq "Established"}

# 4. æ£€æŸ¥ç½‘ç»œé€‚é…å™¨
Get-NetAdapter

# 5. æŸ¥çœ‹IPé…ç½®
Get-NetIPAddress

# 6. æ£€æŸ¥è·¯ç”±è¡¨
Get-NetRoute

# 7. æŸ¥çœ‹DNSé…ç½®
Get-DnsClientServerAddress

# 8. æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€
Get-NetFirewallProfile

# 9. æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™
Get-NetFirewallRule | Where-Object {$_.Enabled -eq "True"}

# 10. æ£€æŸ¥ç½‘ç»œç»Ÿè®¡
Get-NetAdapterStatistics
</div>

<h4>ğŸš¨ å¯ç–‘ç½‘ç»œæ´»åŠ¨</h4>
<ul>
<li><strong>å¼‚å¸¸å¤–è¿</strong> - è¿æ¥åˆ°å¯ç–‘IPåœ°å€æˆ–åŸŸå</li>
<li><strong>éæ ‡å‡†ç«¯å£</strong> - ä½¿ç”¨å¼‚å¸¸ç«¯å£è¿›è¡Œé€šä¿¡</li>
<li><strong>å¤§é‡è¿æ¥</strong> - å¼‚å¸¸é«˜çš„å¹¶å‘è¿æ¥æ•°</li>
<li><strong>é˜²ç«å¢™å…³é—­</strong> - Windowsé˜²ç«å¢™è¢«ç¦ç”¨</li>
<li><strong>DNSåŠ«æŒ</strong> - DNSè®¾ç½®è¢«æ¶æ„ä¿®æ”¹</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å¯ç”¨Windowsé˜²ç«å¢™</li>
<li>ç›‘æ§ç½‘ç»œè¿æ¥æ´»åŠ¨</li>
<li>ä½¿ç”¨å®‰å…¨çš„DNSæœåŠ¡å™¨</li>
<li>å®šæœŸæ£€æŸ¥ç½‘ç»œé…ç½®</li>
<li>å®æ–½ç½‘ç»œè®¿é—®æ§åˆ¶</li>
</ul>
</div>
    `,
    
    filesystem: `
<div class="tutorial-content">
<h3>ğŸ“ Windowsæ–‡ä»¶ç³»ç»Ÿå®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ–‡ä»¶ç³»ç»Ÿæ˜¯æ”»å‡»è€…æ¤å…¥æ¶æ„æ–‡ä»¶ã€ç¯¡æ”¹ç³»ç»Ÿé…ç½®å’Œå­˜å‚¨çªƒå–æ•°æ®çš„ä¸»è¦ç›®æ ‡ã€‚é€šè¿‡æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å¯ä»¥å‘ç°æ¶æ„æ–‡ä»¶å’Œç³»ç»Ÿå®Œæ•´æ€§é—®é¢˜ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>ç³»ç»Ÿæ–‡ä»¶å®Œæ•´æ€§</strong> - æ£€æŸ¥å…³é”®ç³»ç»Ÿæ–‡ä»¶</li>
<li><strong>ä¸´æ—¶ç›®å½•æ£€æŸ¥</strong> - æŸ¥æ‰¾å¯ç–‘çš„ä¸´æ—¶æ–‡ä»¶</li>
<li><strong>ä¸‹è½½ç›®å½•å®¡æŸ¥</strong> - æ£€æŸ¥æœ€è¿‘ä¸‹è½½çš„æ–‡ä»¶</li>
<li><strong>æ–‡ä»¶æƒé™æ£€æŸ¥</strong> - éªŒè¯æ–‡ä»¶æƒé™è®¾ç½®</li>
<li><strong>éšè—æ–‡ä»¶å‘ç°</strong> - æŸ¥æ‰¾éšè—çš„æ¶æ„æ–‡ä»¶</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶å®Œæ•´æ€§
sfc /scannow

# 2. æŸ¥æ‰¾æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶
Get-ChildItem -Path "C:\Windows\System32" -Recurse | Where-Object {$_.LastWriteTime -gt (Get-Date).AddDays(-7)}

# 3. æ£€æŸ¥ä¸´æ—¶ç›®å½•
Get-ChildItem -Path $env:TEMP -Recurse -Force

# 4. æŸ¥çœ‹ä¸‹è½½ç›®å½•
Get-ChildItem -Path "$env:USERPROFILE\Downloads" | Where-Object {$_.CreationTime -gt (Get-Date).AddDays(-7)}

# 5. æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶
Get-ChildItem -Path "C:\" -Recurse -Include "*.exe", "*.bat", "*.cmd", "*.ps1" -ErrorAction SilentlyContinue

# 6. æ£€æŸ¥æ–‡ä»¶æƒé™
Get-Acl -Path "C:\Windows\System32\notepad.exe"

# 7. æŸ¥æ‰¾éšè—æ–‡ä»¶
Get-ChildItem -Path "C:\" -Recurse -Hidden -ErrorAction SilentlyContinue

# 8. æ£€æŸ¥æ–‡ä»¶å“ˆå¸Œ
Get-FileHash -Path "C:\Windows\System32\notepad.exe" -Algorithm SHA256

# 9. æŸ¥æ‰¾å¤§æ–‡ä»¶
Get-ChildItem -Path "C:\" -Recurse | Where-Object {$_.Length -gt 100MB} -ErrorAction SilentlyContinue
</div>

<h4>ğŸš¨ å¯ç–‘æ–‡ä»¶ç‰¹å¾</h4>
<ul>
<li><strong>ä¸´æ—¶ç›®å½•å¯æ‰§è¡Œæ–‡ä»¶</strong> - åœ¨ä¸´æ—¶ç›®å½•ä¸­çš„exeã€batç­‰æ–‡ä»¶</li>
<li><strong>ç³»ç»Ÿç›®å½•å¼‚å¸¸æ–‡ä»¶</strong> - ç³»ç»Ÿç›®å½•ä¸­çš„éç³»ç»Ÿæ–‡ä»¶</li>
<li><strong>æ— ç­¾åæ–‡ä»¶</strong> - ç¼ºå°‘æ•°å­—ç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li><strong>éšè—å±æ€§æ–‡ä»¶</strong> - å…·æœ‰éšè—å±æ€§çš„å¯ç–‘æ–‡ä»¶</li>
<li><strong>å¼‚å¸¸å¤§å°æ–‡ä»¶</strong> - å¤§å°å¼‚å¸¸çš„ç³»ç»Ÿæ–‡ä»¶</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸè¿è¡Œç³»ç»Ÿæ–‡ä»¶æ£€æŸ¥</li>
<li>ç›‘æ§å…³é”®ç›®å½•å˜åŒ–</li>
<li>é™åˆ¶ä¸´æ—¶ç›®å½•æ‰§è¡Œæƒé™</li>
<li>ä½¿ç”¨æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§</li>
<li>å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶</li>
</ul>
</div>
    `,
    
    registry: `
<div class="tutorial-content">
<h3>ğŸ“‹ Windowsæ³¨å†Œè¡¨å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æ³¨å†Œè¡¨æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>Windowsæ³¨å†Œè¡¨æ˜¯ç³»ç»Ÿé…ç½®çš„æ ¸å¿ƒæ•°æ®åº“ã€‚æ”»å‡»è€…ç»å¸¸é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨æ¥å®ç°æŒä¹…åŒ–ã€éšè—æ¶æ„è½¯ä»¶å’Œæ”¹å˜ç³»ç»Ÿè¡Œä¸ºã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>å¯åŠ¨é¡¹æ³¨å†Œè¡¨</strong> - æ£€æŸ¥è‡ªå¯åŠ¨ç¨‹åºé…ç½®</li>
<li><strong>æœåŠ¡æ³¨å†Œè¡¨</strong> - éªŒè¯ç³»ç»ŸæœåŠ¡é…ç½®</li>
<li><strong>å®‰å…¨ç­–ç•¥</strong> - æ£€æŸ¥å®‰å…¨ç›¸å…³æ³¨å†Œè¡¨é¡¹</li>
<li><strong>æ–‡ä»¶å…³è”</strong> - éªŒè¯æ–‡ä»¶ç±»å‹å…³è”</li>
<li><strong>ç³»ç»Ÿé…ç½®</strong> - æ£€æŸ¥å…³é”®ç³»ç»Ÿé…ç½®é¡¹</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æ£€æŸ¥å¯åŠ¨é¡¹æ³¨å†Œè¡¨
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
Get-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"

# 2. æŸ¥çœ‹RunOnceé¡¹
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"
Get-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"

# 3. æ£€æŸ¥æœåŠ¡æ³¨å†Œè¡¨
Get-ChildItem -Path "HKLM:\SYSTEM\CurrentControlSet\Services"

# 4. æŸ¥çœ‹æœ€è¿‘è¿è¡Œçš„ç¨‹åº
Get-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU"

# 5. æ£€æŸ¥æ–‡ä»¶å…³è”
Get-ItemProperty -Path "HKLM:\SOFTWARE\Classes\.exe"

# 6. æŸ¥çœ‹å®‰è£…çš„ç¨‹åº
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"

# 7. æ£€æŸ¥ç½‘ç»œè®¾ç½®
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"

# 8. æŸ¥çœ‹ç”¨æˆ·é…ç½®æ–‡ä»¶
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\*"
</div>

<h4>ğŸš¨ å¯ç–‘æ³¨å†Œè¡¨é¡¹</h4>
<ul>
<li><strong>å¼‚å¸¸å¯åŠ¨é¡¹</strong> - æŒ‡å‘å¯ç–‘æ–‡ä»¶çš„å¯åŠ¨é¡¹</li>
<li><strong>æœªçŸ¥æœåŠ¡</strong> - ä¸æ˜æ¥æºçš„ç³»ç»ŸæœåŠ¡</li>
<li><strong>ä¿®æ”¹çš„æ–‡ä»¶å…³è”</strong> - è¢«æ¶æ„ä¿®æ”¹çš„æ–‡ä»¶ç±»å‹å…³è”</li>
<li><strong>å¼‚å¸¸ç½‘ç»œé…ç½®</strong> - è¢«ç¯¡æ”¹çš„ç½‘ç»œè®¾ç½®</li>
<li><strong>å®‰å…¨ç­–ç•¥å˜æ›´</strong> - è¢«ä¿®æ”¹çš„å®‰å…¨ç­–ç•¥</li>
</ul>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸå¤‡ä»½æ³¨å†Œè¡¨</li>
<li>ç›‘æ§å…³é”®æ³¨å†Œè¡¨é¡¹å˜åŒ–</li>
<li>ä½¿ç”¨ç»„ç­–ç•¥ç®¡ç†é…ç½®</li>
<li>é™åˆ¶æ³¨å†Œè¡¨ä¿®æ”¹æƒé™</li>
<li>å®¡è®¡æ³¨å†Œè¡¨è®¿é—®</li>
</ul>
</div>
    `,
    
    logs: `
<div class="tutorial-content">
<h3>ğŸ“‹ Windowsæ—¥å¿—åˆ†æå®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æ—¥å¿—åˆ†æçš„é‡è¦æ€§</h4>
<p>Windowsäº‹ä»¶æ—¥å¿—è®°å½•äº†ç³»ç»Ÿçš„æ‰€æœ‰é‡è¦æ´»åŠ¨ã€‚é€šè¿‡ä¸“ä¸šçš„æ—¥å¿—åˆ†æå¯ä»¥å‘ç°æ”»å‡»ç—•è¿¹ã€é‡å»ºæ”»å‡»æ—¶é—´çº¿ï¼Œå¹¶è¯„ä¼°å®‰å…¨äº‹ä»¶çš„å½±å“èŒƒå›´ã€‚</p>

<h4>ğŸ” æ—¥å¿—åˆ†æè¦ç‚¹</h4>
<ol>
<li><strong>å®‰å…¨æ—¥å¿—åˆ†æ</strong> - åˆ†æç™»å½•ã€æƒé™å˜æ›´ç­‰å®‰å…¨äº‹ä»¶</li>
<li><strong>ç³»ç»Ÿæ—¥å¿—æ£€æŸ¥</strong> - æ£€æŸ¥ç³»ç»Ÿé”™è¯¯å’Œå¼‚å¸¸</li>
<li><strong>åº”ç”¨ç¨‹åºæ—¥å¿—</strong> - åˆ†æåº”ç”¨ç¨‹åºç›¸å…³äº‹ä»¶</li>
<li><strong>äº‹ä»¶å…³è”åˆ†æ</strong> - å¤šç»´åº¦å…³è”åˆ†æ</li>
<li><strong>æ—¶é—´çº¿é‡å»º</strong> - æ„å»ºå®Œæ•´çš„äº‹ä»¶æ—¶é—´çº¿</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹ç™»å½•æˆåŠŸäº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} -MaxEvents 100

# 2. æŸ¥çœ‹ç™»å½•å¤±è´¥äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} -MaxEvents 100

# 3. æŸ¥çœ‹è´¦æˆ·é”å®šäº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4740} -MaxEvents 50

# 4. æŸ¥çœ‹æƒé™æå‡äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4672} -MaxEvents 50

# 5. æŸ¥çœ‹ç³»ç»Ÿé”™è¯¯äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='System'; Level=2} -MaxEvents 50

# 6. æŸ¥çœ‹åº”ç”¨ç¨‹åºé”™è¯¯
Get-WinEvent -FilterHashtable @{LogName='Application'; Level=2} -MaxEvents 50

# 7. æŸ¥çœ‹æœåŠ¡å¯åŠ¨åœæ­¢äº‹ä»¶
Get-WinEvent -FilterHashtable @{LogName='System'; ID=7034,7035,7036} -MaxEvents 50

# 8. æŸ¥çœ‹è¿›ç¨‹åˆ›å»ºäº‹ä»¶ï¼ˆéœ€è¦å¯ç”¨å®¡è®¡ï¼‰
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4688} -MaxEvents 100

# 9. æŸ¥çœ‹æ–‡ä»¶è®¿é—®äº‹ä»¶ï¼ˆéœ€è¦å¯ç”¨å®¡è®¡ï¼‰
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4656,4658} -MaxEvents 50
</div>

<h4>ğŸš¨ å…³é”®å®‰å…¨äº‹ä»¶ID</h4>
<ul>
<li><strong>4624</strong> - è´¦æˆ·æˆåŠŸç™»å½•</li>
<li><strong>4625</strong> - è´¦æˆ·ç™»å½•å¤±è´¥</li>
<li><strong>4648</strong> - ä½¿ç”¨æ˜¾å¼å‡­æ®ç™»å½•</li>
<li><strong>4672</strong> - åˆ†é…äº†ç‰¹æ®Šæƒé™</li>
<li><strong>4688</strong> - æ–°è¿›ç¨‹å·²åˆ›å»º</li>
<li><strong>4740</strong> - ç”¨æˆ·è´¦æˆ·è¢«é”å®š</li>
<li><strong>4756</strong> - æˆå‘˜å·²æ·»åŠ åˆ°å®‰å…¨ç»„</li>
<li><strong>4720</strong> - ç”¨æˆ·è´¦æˆ·å·²åˆ›å»º</li>
</ul>

<h4>ğŸ”§ æ—¥å¿—åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ—¶é—´å…³è”</strong> - åˆ†æäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´æ¨¡å¼</li>
<li><strong>ç”¨æˆ·è¡Œä¸º</strong> - åˆ†æç”¨æˆ·æ´»åŠ¨æ¨¡å¼</li>
<li><strong>IPåœ°å€åˆ†æ</strong> - è¯†åˆ«å¼‚å¸¸æ¥æºIP</li>
<li><strong>å¤±è´¥æ¨¡å¼</strong> - åˆ†æç™»å½•å¤±è´¥çš„æ¨¡å¼</li>
<li><strong>æƒé™å˜æ›´</strong> - ç›‘æ§æƒé™æå‡äº‹ä»¶</li>
</ol>

<h4>ğŸ›¡ï¸ æ—¥å¿—å®‰å…¨å»ºè®®</h4>
<ul>
<li>å¯ç”¨è¯¦ç»†çš„å®‰å…¨å®¡è®¡</li>
<li>å®šæœŸåˆ†æå®‰å…¨æ—¥å¿—</li>
<li>è®¾ç½®æ—¥å¿—å‘Šè­¦è§„åˆ™</li>
<li>ä¿æŠ¤æ—¥å¿—æ–‡ä»¶å®‰å…¨</li>
<li>å»ºç«‹æ—¥å¿—å¤‡ä»½ç­–ç•¥</li>
</ul>
</div>
    `,
    
    tasks: `
<div class="tutorial-content">
<h3>â° Windowsè®¡åˆ’ä»»åŠ¡å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– è®¡åˆ’ä»»åŠ¡æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>Windowsè®¡åˆ’ä»»åŠ¡æ˜¯æ”»å‡»è€…å®ç°æŒä¹…åŒ–çš„å¸¸ç”¨æ–¹æ³•ã€‚æ¶æ„çš„è®¡åˆ’ä»»åŠ¡å¯ä»¥åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶æˆ–ç‰¹å®šæ—¶é—´æ‰§è¡Œæ¶æ„ä»£ç ï¼Œç»´æŒå¯¹ç³»ç»Ÿçš„æ§åˆ¶ã€‚</p>

<h4>ğŸ” æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>ä»»åŠ¡åˆæ³•æ€§</strong> - éªŒè¯è®¡åˆ’ä»»åŠ¡çš„åˆæ³•æ€§</li>
<li><strong>æ‰§è¡Œæƒé™</strong> - æ£€æŸ¥ä»»åŠ¡çš„æ‰§è¡Œæƒé™</li>
<li><strong>è§¦å‘æ¡ä»¶</strong> - åˆ†æä»»åŠ¡çš„è§¦å‘æ¡ä»¶</li>
<li><strong>æ‰§è¡Œå†…å®¹</strong> - æ£€æŸ¥ä»»åŠ¡æ‰§è¡Œçš„å‘½ä»¤æˆ–è„šæœ¬</li>
<li><strong>åˆ›å»ºæ—¶é—´</strong> - å…³æ³¨ä»»åŠ¡çš„åˆ›å»ºæ—¶é—´</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æŸ¥çœ‹æ‰€æœ‰è®¡åˆ’ä»»åŠ¡
Get-ScheduledTask

# 2. æŸ¥çœ‹è¿è¡Œä¸­çš„ä»»åŠ¡
Get-ScheduledTask | Where-Object {$_.State -eq "Running"}

# 3. æŸ¥çœ‹å°±ç»ªçŠ¶æ€çš„ä»»åŠ¡
Get-ScheduledTask | Where-Object {$_.State -eq "Ready"}

# 4. è·å–ä»»åŠ¡è¯¦ç»†ä¿¡æ¯
Get-ScheduledTaskInfo -TaskName "TaskName"

# 5. æŸ¥çœ‹ä»»åŠ¡çš„æ“ä½œ
Get-ScheduledTask | Select-Object TaskName, Actions

# 6. æŸ¥çœ‹ä»»åŠ¡çš„è§¦å‘å™¨
Get-ScheduledTask | Select-Object TaskName, Triggers

# 7. æŸ¥çœ‹ç‰¹å®šè·¯å¾„ä¸‹çš„ä»»åŠ¡
Get-ScheduledTask -TaskPath "\Microsoft\Windows\*"

# 8. å¯¼å‡ºä»»åŠ¡é…ç½®
Export-ScheduledTask -TaskName "TaskName"

# 9. æŸ¥çœ‹ä»»åŠ¡å†å²
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-TaskScheduler/Operational'} -MaxEvents 100
</div>

<h4>ğŸš¨ å¯ç–‘ä»»åŠ¡ç‰¹å¾</h4>
<ul>
<li><strong>å¼‚å¸¸æ‰§è¡Œè·¯å¾„</strong> - æ‰§è¡Œä¸´æ—¶ç›®å½•æˆ–ç”¨æˆ·ç›®å½•ä¸­çš„æ–‡ä»¶</li>
<li><strong>å¯ç–‘å‘½ä»¤</strong> - æ‰§è¡ŒPowerShellã€cmdç­‰å‘½ä»¤è¡Œå·¥å…·</li>
<li><strong>é«˜æƒé™æ‰§è¡Œ</strong> - ä»¥SYSTEMæƒé™è¿è¡Œçš„å¯ç–‘ä»»åŠ¡</li>
<li><strong>é¢‘ç¹è§¦å‘</strong> - å¼‚å¸¸é¢‘ç¹çš„è§¦å‘æ¡ä»¶</li>
<li><strong>éšè—ä»»åŠ¡</strong> - åœ¨éæ ‡å‡†ä½ç½®çš„ä»»åŠ¡</li>
</ul>

<h4>ğŸ”§ åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ—¶é—´å…³è”</strong> - å°†ä»»åŠ¡åˆ›å»ºæ—¶é—´ä¸å®‰å…¨äº‹ä»¶å…³è”</li>
<li><strong>æƒé™åˆ†æ</strong> - æ£€æŸ¥ä»»åŠ¡çš„æ‰§è¡Œæƒé™</li>
<li><strong>å†…å®¹åˆ†æ</strong> - åˆ†æä»»åŠ¡æ‰§è¡Œçš„è„šæœ¬å†…å®¹</li>
<li><strong>ç½‘ç»œæ´»åŠ¨</strong> - æ£€æŸ¥ä»»åŠ¡æ˜¯å¦æœ‰ç½‘ç»œæ´»åŠ¨</li>
<li><strong>æ–‡ä»¶ä¾èµ–</strong> - åˆ†æä»»åŠ¡ä¾èµ–çš„æ–‡ä»¶</li>
</ol>

<h4>ğŸ›¡ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸå®¡æŸ¥è®¡åˆ’ä»»åŠ¡</li>
<li>é™åˆ¶ä»»åŠ¡åˆ›å»ºæƒé™</li>
<li>ç›‘æ§ä»»åŠ¡æ‰§è¡Œæ—¥å¿—</li>
<li>ä½¿ç”¨ç»„ç­–ç•¥ç®¡ç†ä»»åŠ¡</li>
<li>å»ºç«‹ä»»åŠ¡ç™½åå•</li>
</ul>
</div>
    `,
    
    malware: `
<div class="tutorial-content">
<h3>ğŸ¦  Windowsæ¶æ„è½¯ä»¶æ£€æµ‹æŒ‡å—</h3>

<h4>ğŸ“– æ¶æ„è½¯ä»¶æ£€æµ‹çš„é‡è¦æ€§</h4>
<p>æ¶æ„è½¯ä»¶æ˜¯Windowsç³»ç»Ÿé¢ä¸´çš„ä¸»è¦å¨èƒä¹‹ä¸€ã€‚åŠæ—¶å‘ç°å’Œæ¸…é™¤æ¶æ„è½¯ä»¶å¯¹äºä¿æŠ¤ç³»ç»Ÿå®‰å…¨å’Œæ•°æ®å®Œæ•´æ€§è‡³å…³é‡è¦ã€‚</p>

<h4>ğŸ” æ£€æµ‹è¦ç‚¹</h4>
<ol>
<li><strong>é˜²ç—…æ¯’çŠ¶æ€</strong> - æ£€æŸ¥Windows Defenderç­‰é˜²ç—…æ¯’è½¯ä»¶çŠ¶æ€</li>
<li><strong>è¿›ç¨‹è¡Œä¸º</strong> - åˆ†æå¯ç–‘è¿›ç¨‹çš„è¡Œä¸ºç‰¹å¾</li>
<li><strong>ç½‘ç»œè¿æ¥</strong> - æ£€æµ‹å¼‚å¸¸çš„ç½‘ç»œé€šä¿¡</li>
<li><strong>æ–‡ä»¶ç‰¹å¾</strong> - è¯†åˆ«æ¶æ„æ–‡ä»¶ç‰¹å¾</li>
<li><strong>ç³»ç»Ÿå˜æ›´</strong> - ç›‘æ§ç³»ç»Ÿé…ç½®å˜æ›´</li>
</ol>

<h4>ğŸ’» å…³é”®PowerShellå‘½ä»¤</h4>
<div class="command-block">
# 1. æ£€æŸ¥Windows DefenderçŠ¶æ€
Get-MpComputerStatus

# 2. æŸ¥çœ‹å¨èƒæ£€æµ‹å†å²
Get-MpThreatDetection

# 3. è¿è¡Œå¿«é€Ÿæ‰«æ
Start-MpScan -ScanType QuickScan

# 4. æŸ¥çœ‹æ’é™¤é¡¹
Get-MpPreference | Select-Object ExclusionPath, ExclusionProcess

# 5. æ£€æŸ¥å®æ—¶ä¿æŠ¤çŠ¶æ€
Get-MpComputerStatus | Select-Object RealTimeProtectionEnabled

# 6. æŸ¥çœ‹å¯ç–‘ç½‘ç»œè¿æ¥
Get-NetTCPConnection | Where-Object {$_.RemoteAddress -notmatch "^(127\.|10\.|172\.(1[6-9]|2[0-9]|3[01])\.|192\.168\.)"}

# 7. æ£€æŸ¥å¼‚å¸¸è¿›ç¨‹
Get-Process | Where-Object {$_.ProcessName -match "^[a-f0-9]{8,}$"}

# 8. æŸ¥çœ‹ç­¾åçŠ¶æ€
Get-ChildItem -Path "C:\Windows\System32\*.exe" | Get-AuthenticodeSignature | Where-Object {$_.Status -ne "Valid"}

# 9. æ£€æŸ¥å¯åŠ¨é¡¹
Get-CimInstance -ClassName Win32_StartupCommand | Where-Object {$_.Command -match "(temp|tmp|appdata)"}
</div>

<h4>ğŸš¨ æ¶æ„è½¯ä»¶ç‰¹å¾</h4>
<ul>
<li><strong>é˜²ç—…æ¯’è¢«ç¦ç”¨</strong> - Windows Defenderæˆ–å…¶ä»–é˜²ç—…æ¯’è½¯ä»¶è¢«å…³é—­</li>
<li><strong>å¼‚å¸¸ç½‘ç»œè¿æ¥</strong> - è¿æ¥åˆ°å¯ç–‘IPæˆ–åŸŸå</li>
<li><strong>æ— ç­¾åæ–‡ä»¶</strong> - ç¼ºå°‘æ•°å­—ç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li><strong>å¼‚å¸¸è¿›ç¨‹å</strong> - éšæœºå­—ç¬¦å‘½åçš„è¿›ç¨‹</li>
<li><strong>é«˜èµ„æºå ç”¨</strong> - å¼‚å¸¸é«˜çš„CPUæˆ–ç½‘ç»œä½¿ç”¨</li>
</ul>

<h4>ğŸ”§ æ£€æµ‹æŠ€å·§</h4>
<ol>
<li><strong>è¡Œä¸ºåˆ†æ</strong> - ç›‘æ§è¿›ç¨‹çš„å¼‚å¸¸è¡Œä¸º</li>
<li><strong>ç½‘ç»œç›‘æ§</strong> - åˆ†æç½‘ç»œæµé‡æ¨¡å¼</li>
<li><strong>æ–‡ä»¶åˆ†æ</strong> - æ£€æŸ¥æ–‡ä»¶çš„å“ˆå¸Œå€¼å’Œç­¾å</li>
<li><strong>å†…å­˜åˆ†æ</strong> - åˆ†æå†…å­˜ä¸­çš„æ¶æ„ä»£ç </li>
<li><strong>æ²™ç®±åˆ†æ</strong> - åœ¨éš”ç¦»ç¯å¢ƒä¸­åˆ†æå¯ç–‘æ–‡ä»¶</li>
</ol>

<h4>ğŸ›¡ï¸ é˜²æŠ¤å»ºè®®</h4>
<ul>
<li>ä¿æŒWindows Defenderå¯ç”¨</li>
<li>å®šæœŸæ›´æ–°ç—…æ¯’å®šä¹‰</li>
<li>ä½¿ç”¨åº”ç”¨ç¨‹åºç™½åå•</li>
<li>ç›‘æ§ç³»ç»Ÿè¡Œä¸ºå˜åŒ–</li>
<li>å®šæœŸè¿›è¡Œå…¨ç›˜æ‰«æ</li>
</ul>
</div>
    `
  };
  
  return tutorials[category] || '<p>è¯¥æ¨¡å—çš„æ•™ç¨‹æ­£åœ¨å®Œå–„ä¸­...</p>';
}

// æ–‡ä»¶ä¸Šä¼ å¤„ç†
document.getElementById('fileInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      gContent = e.target.result;
      parseAndRenderReport(gContent);
    };
    reader.readAsText(file);
  }
});

// è§£æå¹¶æ¸²æŸ“æŠ¥å‘Š
function parseAndRenderReport(content) {
  const data = {};
  
  // è§£æWindowsæŠ¥å‘Šå†…å®¹
  const sections = content.split(/={60,}/);
  
  sections.forEach(section => {
    const lines = section.trim().split('\n');
    if (lines.length > 0) {
      const title = lines[0].trim();
      
      // æ˜ å°„åˆ°å¯¹åº”çš„æ ‡ç­¾
      if (title.includes('ç³»ç»Ÿä¿¡æ¯')) {
        data.system = parseSystemSection(section);
      } else if (title.includes('ç”¨æˆ·å’Œæƒé™')) {
        data.user = parseUserSection(section);
      } else if (title.includes('è¿›ç¨‹å’ŒæœåŠ¡')) {
        data.process = parseProcessSection(section);
      } else if (title.includes('ç½‘ç»œè¿æ¥')) {
        data.network = parseNetworkSection(section);
      } else if (title.includes('æ–‡ä»¶ç³»ç»Ÿ')) {
        data.filesystem = parseFilesystemSection(section);
      } else if (title.includes('æ³¨å†Œè¡¨')) {
        data.registry = parseRegistrySection(section);
      } else if (title.includes('æ—¥å¿—åˆ†æ')) {
        data.logs = parseLogsSection(section);
      } else if (title.includes('è®¡åˆ’ä»»åŠ¡')) {
        data.tasks = parseTasksSection(section);
      } else if (title.includes('æ¶æ„è½¯ä»¶')) {
        data.malware = parseMalwareSection(section);
      } else if (title.includes('å®‰å…¨ç»Ÿè®¡æ±‡æ€»')) {
        data.stats = parseStatsSection(section);
      }
    }
  });
  
  // ç”Ÿæˆæ¦‚è§ˆæ•°æ®
  data.summary = generateSummaryContent(data);
  
  renderTabs(data);
}

// è§£æå„ä¸ªéƒ¨åˆ†çš„å‡½æ•°
function parseSystemSection(content) {
  const subsections = content.split(/-{40,}/);
  const result = {};
  
  subsections.forEach(sub => {
    const lines = sub.trim().split('\n');
    if (lines.length > 1) {
      const title = lines[0].trim();
      const content = lines.slice(1).join('\n');
      result[title] = content;
    }
  });
  
  return result;
}

function parseUserSection(content) {
  return parseSystemSection(content);
}

function parseProcessSection(content) {
  return parseSystemSection(content);
}

function parseNetworkSection(content) {
  return parseSystemSection(content);
}

function parseFilesystemSection(content) {
  return parseSystemSection(content);
}

function parseRegistrySection(content) {
  return parseSystemSection(content);
}

function parseLogsSection(content) {
  return parseSystemSection(content);
}

function parseTasksSection(content) {
  return parseSystemSection(content);
}

function parseMalwareSection(content) {
  return parseSystemSection(content);
}

function parseStatsSection(content) {
  return parseSystemSection(content);
}

// ç”Ÿæˆæ¦‚è§ˆå†…å®¹
function generateSummaryContent(data) {
  let summary = "Windowsç³»ç»Ÿåº”æ€¥å“åº”æŠ¥å‘Šæ¦‚è§ˆ\n\n";
  
  // ç»Ÿè®¡ä¿¡æ¯
  summary += "æ£€æŸ¥æ¨¡å—ç»Ÿè®¡:\n";
  Object.keys(data).forEach(key => {
    if (key !== 'summary') {
      const moduleData = data[key];
      const itemCount = Object.keys(moduleData || {}).length;
      summary += `- ${TAB_TITLES[key]}: ${itemCount} ä¸ªæ£€æŸ¥é¡¹\n`;
    }
  });
  
  summary += "\nå®‰å…¨çŠ¶å†µè¯„ä¼°:\n";
  summary += "- ç³»ç»Ÿä¿¡æ¯: å·²æ”¶é›†\n";
  summary += "- ç”¨æˆ·æƒé™: å·²æ£€æŸ¥\n";
  summary += "- è¿›ç¨‹æœåŠ¡: å·²åˆ†æ\n";
  summary += "- ç½‘ç»œè¿æ¥: å·²ç›‘æ§\n";
  summary += "- æ–‡ä»¶ç³»ç»Ÿ: å·²æ‰«æ\n";
  summary += "- æ³¨å†Œè¡¨: å·²å®¡æŸ¥\n";
  summary += "- ç³»ç»Ÿæ—¥å¿—: å·²åˆ†æ\n";
  summary += "- è®¡åˆ’ä»»åŠ¡: å·²æ£€æŸ¥\n";
  summary += "- æ¶æ„è½¯ä»¶: å·²æ£€æµ‹\n";
  
  return {
    "ç³»ç»Ÿæ¦‚è§ˆ": summary,
    "é£é™©è¯„ä¼°": "åŸºäºæ£€æŸ¥ç»“æœè¿›è¡Œé£é™©è¯„ä¼°...",
    "æ™ºèƒ½å»ºè®®": "æ ¹æ®å‘ç°çš„é—®é¢˜æä¾›å¤„ç½®å»ºè®®...",
    "æ£€æŸ¥æ¸…å•": "Windowså®‰å…¨æ£€æŸ¥æ¸…å•...",
    "ä¸“ä¸šæ€»ç»“": "åŸºäºNISTæ¡†æ¶çš„ä¸“ä¸šåˆ†ææ€»ç»“..."
  };
}

// æ¸²æŸ“æ ‡ç­¾é¡µ
function renderTabs(data) {
  analysisData = data;
  
  const tabBtnHtml = gTabs.map((k, i) => 
    `<button class="tablinks" onclick="openTab(event, '${k}')">${TAB_TITLES[k]}</button>`
  ).join("");
  document.getElementById("tabBtns").innerHTML = tabBtnHtml;

  const tabContentHtml = gTabs.map(k => {
    const subTitles = SUB_TAB_TITLES[k];
    const subContent = subTitles.map(title => {
      let content = "";
      if (title === 'ğŸ“š æ’æŸ¥æ•™ç¨‹') {
        content = generateWindowsTutorial(k);
        return `<details><summary>${title}</summary><div style="padding: 10px;">${content}</div></details>`;
      } else {
        content = data[k] && data[k][title] ? data[k][title] : "";
        return `<details open><summary>${title}</summary><pre>${escapeHtml(content)}</pre></details>`;
      }
    }).join("");
    return `<div id="${k}" class="tabcontent">${subContent}</div>`;
  }).join("");
  document.getElementById("tabContents").innerHTML = tabContentHtml;

  if (gTabs.length) {
    setTimeout(() => document.getElementsByClassName("tablinks")[0].click(), 100);
  }
  
  // è°ƒç”¨è§„åˆ™å¼•æ“APIè¿›è¡Œåˆ†æ
  analyzeReport(data);
}

// HTMLè½¬ä¹‰å‡½æ•°
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// æ‰“å¼€æ ‡ç­¾é¡µ
function openTab(evt, tabName) {
  const tabcontent = document.getElementsByClassName("tabcontent");
  for (let i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  const tablinks = document.getElementsByClassName("tablinks");
  for (let i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}

// æœç´¢åŠŸèƒ½
function searchTabs() {
  const searchTerm = document.getElementById('searchInput').value.toLowerCase();
  const searchCount = document.getElementById('searchCount');
  const prevBtn = document.getElementById('prevMatch');
  const nextBtn = document.getElementById('nextMatch');
  
  // æ¸…é™¤ä¹‹å‰çš„é«˜äº®
  clearHighlights();
  
  if (searchTerm.length < 2) {
    searchCount.textContent = "è¾“å…¥å…³é”®è¯æœç´¢";
    prevBtn.disabled = true;
    nextBtn.disabled = true;
    searchMatches = [];
    currentSearchIndex = -1;
    return;
  }
  
  // æŸ¥æ‰¾åŒ¹é…é¡¹
  searchMatches = [];
  const allContent = document.querySelectorAll('.tabcontent pre, .tabcontent div');
  
  allContent.forEach((element, elementIndex) => {
    const text = element.textContent || element.innerText;
    const regex = new RegExp(searchTerm, 'gi');
    let match;
    
    while ((match = regex.exec(text)) !== null) {
      searchMatches.push({
        element: element,
        index: match.index,
        length: searchTerm.length,
        elementIndex: elementIndex
      });
    }
  });
  
  if (searchMatches.length > 0) {
    searchCount.textContent = `æ‰¾åˆ° ${searchMatches.length} ä¸ªåŒ¹é…é¡¹`;
    prevBtn.disabled = false;
    nextBtn.disabled = false;
    currentSearchIndex = 0;
    highlightMatches();
    navigateToMatch(0);
  } else {
    searchCount.textContent = "æœªæ‰¾åˆ°åŒ¹é…é¡¹";
    prevBtn.disabled = true;
    nextBtn.disabled = true;
  }
}

// é«˜äº®åŒ¹é…é¡¹
function highlightMatches() {
  searchMatches.forEach((match, index) => {
    const element = match.element;
    const text = element.innerHTML;
    const searchTerm = document.getElementById('searchInput').value;
    const regex = new RegExp(`(${escapeRegExp(searchTerm)})`, 'gi');
    const highlightedText = text.replace(regex, `<span class="highlight" data-match-index="${index}">$1</span>`);
    element.innerHTML = highlightedText;
  });
}

// æ¸…é™¤é«˜äº®
function clearHighlights() {
  const highlights = document.querySelectorAll('.highlight');
  highlights.forEach(highlight => {
    const parent = highlight.parentNode;
    parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
    parent.normalize();
  });
}

// å¯¼èˆªåˆ°åŒ¹é…é¡¹
function navigateSearch(direction) {
  if (searchMatches.length === 0) return;
  
  currentSearchIndex += direction;
  if (currentSearchIndex >= searchMatches.length) {
    currentSearchIndex = 0;
  } else if (currentSearchIndex < 0) {
    currentSearchIndex = searchMatches.length - 1;
  }
  
  navigateToMatch(currentSearchIndex);
  document.getElementById('searchCount').textContent = 
    `ç¬¬ ${currentSearchIndex + 1} ä¸ªï¼Œå…± ${searchMatches.length} ä¸ªåŒ¹é…é¡¹`;
}

// å¯¼èˆªåˆ°æŒ‡å®šåŒ¹é…é¡¹
function navigateToMatch(index) {
  const match = searchMatches[index];
  const highlight = document.querySelector(`[data-match-index="${index}"]`);
  
  if (highlight) {
    // æ‰¾åˆ°åŒ…å«è¯¥å…ƒç´ çš„æ ‡ç­¾é¡µ
    let tabContent = highlight.closest('.tabcontent');
    if (tabContent) {
      // æ¿€æ´»å¯¹åº”çš„æ ‡ç­¾é¡µ
      const tabId = tabContent.id;
      const tabButton = document.querySelector(`[onclick="openTab(event, '${tabId}')"]`);
      if (tabButton) {
        tabButton.click();
      }
      
      // å±•å¼€å¯¹åº”çš„detailså…ƒç´ 
      const details = highlight.closest('details');
      if (details) {
        details.open = true;
        details.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }
  }
}

// è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦
function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

// è°ƒç”¨è§„åˆ™å¼•æ“åˆ†æ
async function analyzeReport(data) {
  try {
    // å°†æ•°æ®è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼è¿›è¡Œåˆ†æ
    const reportText = JSON.stringify(data, null, 2);
    
    const response = await fetch('/analyze', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ content: reportText })
    });
    
    if (response.ok) {
      const result = await response.json();
      displayAlerts(result.alerts || []);
    }
  } catch (error) {
    console.log('è§„åˆ™å¼•æ“åˆ†æå¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°åˆ†ææ¨¡å¼');
    performLocalAnalysis(data);
  }
}

// æœ¬åœ°åˆ†ææ¨¡å¼
function performLocalAnalysis(data) {
  const alerts = [];
  
  // ç®€å•çš„æœ¬åœ°è§„åˆ™æ£€æŸ¥
  const reportText = JSON.stringify(data, null, 2);
  
  if (reportText.includes('å®æ—¶ä¿æŠ¤: False')) {
    alerts.push({
      rule_name: 'Windows Defenderå…³é—­',
      description: 'Windows Defenderå®æ—¶ä¿æŠ¤å·²å…³é—­',
      severity: 'high',
      category: 'antivirus'
    });
  }
  
  if (reportText.includes('å¯ç–‘è¿›ç¨‹') || reportText.includes('å¼‚å¸¸è¿›ç¨‹')) {
    alerts.push({
      rule_name: 'å¯ç–‘è¿›ç¨‹æ£€æµ‹',
      description: 'å‘ç°å¯ç–‘çš„è¿›ç¨‹æ´»åŠ¨',
      severity: 'medium',
      category: 'process_security'
    });
  }
  
  displayAlerts(alerts);
}

// æ˜¾ç¤ºå‘Šè­¦
function displayAlerts(alerts) {
  const alertContainer = document.getElementById('alertContainer');
  const alertSummary = document.getElementById('alertSummary');
  
  if (alerts.length === 0) {
    alertContainer.innerHTML = `
      <div style="text-align: center; padding: 40px; color: #27ae60;">
        <h3>âœ… ç³»ç»ŸçŠ¶æ€è‰¯å¥½</h3>
        <p>æœªå‘ç°æ˜æ˜¾çš„å®‰å…¨å¨èƒ</p>
      </div>
    `;
    alertSummary.innerHTML = `
      <div style="color: #27ae60;">
        <strong>å®‰å…¨çŠ¶æ€: è‰¯å¥½</strong><br>
        å‘Šè­¦æ•°é‡: 0
      </div>
    `;
    return;
  }
  
  // ç»Ÿè®¡å‘Šè­¦
  const highAlerts = alerts.filter(a => a.severity === 'high').length;
  const mediumAlerts = alerts.filter(a => a.severity === 'medium').length;
  const lowAlerts = alerts.filter(a => a.severity === 'low').length;
  
  alertSummary.innerHTML = `
    <div>
      <strong>å®‰å…¨å‘Šè­¦ç»Ÿè®¡</strong><br>
      ğŸ”´ é«˜å±: ${highAlerts}<br>
      ğŸŸ¡ ä¸­å±: ${mediumAlerts}<br>
      ğŸŸ¢ ä½å±: ${lowAlerts}<br>
      æ€»è®¡: ${alerts.length}
    </div>
  `;
  
  // æ˜¾ç¤ºå‘Šè­¦è¯¦æƒ…
  let alertHtml = '';
  alerts.forEach(alert => {
    const alertClass = `alert-${alert.severity}`;
    const severityIcon = {
      'high': 'ğŸ”´',
      'medium': 'ğŸŸ¡', 
      'low': 'ğŸŸ¢'
    }[alert.severity] || 'âšª';
    
    alertHtml += `
      <div class="alert-item ${alertClass}">
        <h4>${severityIcon} ${alert.rule_name}</h4>
        <p><strong>æè¿°:</strong> ${alert.description}</p>
        <p><strong>ç±»åˆ«:</strong> ${alert.category}</p>
      </div>
    `;
  });
  
  alertContainer.innerHTML = alertHtml;
}

// åˆ‡æ¢ä¾§è¾¹æ 
function toggleSidebar() {
  const sidebar = document.querySelector('.sidebar');
  const button = document.querySelector('.collapse-button');
  
  sidebar.classList.toggle('collapsed');
  
  if (sidebar.classList.contains('collapsed')) {
    button.textContent = '< å±•å¼€å‘Šè­¦é¢æ¿';
  } else {
    button.textContent = 'æ”¶èµ·å‘Šè­¦é¢æ¿ >';
  }
}

</script>
</head>
<body>
  <div class="header">
    <h1>ğŸ›¡ï¸ Windows åº”æ€¥å“åº”æŠ¥å‘ŠæŸ¥çœ‹å™¨ (è¯¦ç»†ç‰ˆ)</h1>
    <div class="subtitle">ä¸“ä¸šåŒ–Windowså®‰å…¨å¨èƒæ£€æµ‹ä¸åˆ†æç³»ç»Ÿ | è¯¦ç»†æ—¥å¿—åˆ†æ + æ”»å‡»æº¯æº + æŠ€æœ¯æ•™ç¨‹</div>
  </div>

  <div class="main-container">
    <div class="content-container">
      <div class="search-container">
        <input type="file" id="fileInput" accept=".txt,.json">
        <input type="text" id="searchInput" placeholder="æœç´¢æŠ¥å‘Šå†…å®¹..." onkeyup="searchTabs()">
        <div class="search-nav">
          <button id="prevMatch" onclick="navigateSearch(-1)" disabled>ä¸Šä¸€ä¸ª</button>
          <button id="nextMatch" onclick="navigateSearch(1)" disabled>ä¸‹ä¸€ä¸ª</button>
          <span id="searchCount">è¾“å…¥å…³é”®è¯æœç´¢</span>
        </div>
      </div>

      <div class="tabs" id="tabBtns">
        <!-- æ ‡ç­¾æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
      </div>

      <div id="tabContents">
        <!-- æ ‡ç­¾å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>

    <div class="sidebar">
      <div class="sidebar-header">
        <h3>ğŸš¨ å®‰å…¨å‘Šè­¦é¢æ¿</h3>
        <button class="collapse-button" onclick="toggleSidebar()">æ”¶èµ·å‘Šè­¦é¢æ¿ ></button>
        <div id="alertSummary" class="alert-summary">
          <!-- å‘Šè­¦ç»Ÿè®¡å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
        </div>
      </div>
      <div id="alertContainer" class="alert-container">
        <div style="text-align: center; padding: 40px; color: #666;">
          <p>ğŸ“ è¯·é€‰æ‹©æŠ¥å‘Šæ–‡ä»¶å¼€å§‹åˆ†æ</p>
          <p style="font-size: 0.9em; margin-top: 10px;">æ”¯æŒ .txt å’Œ .json æ ¼å¼</p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>